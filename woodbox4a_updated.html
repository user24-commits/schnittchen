
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schnittchen | Planner</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&family=JetBrains+Mono:wght@500&display=swap');
        
        body { background-color: #f1f5f9; font-family: 'Inter', sans-serif; color: #1e293b; }
        
        /* Inputs mit Auto-Select Optik */
        input, select { 
            font-family: 'JetBrains Mono', monospace;
            text-align: center; width: 100%; padding: 0.7rem; border: 1px solid #cbd5e1; 
            border-radius: 0.6rem; background: #ffffff; outline: none; transition: all 0.2s;
            appearance: none; -moz-appearance: textfield;
        }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input:focus, select:focus { border-color: #f59e0b; box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1); }
        
        /* Inaktive Felder Optik */
        .output-field { 
            background-color: #f1f5f9 !important; 
            color: #64748b !important; 
            border-color: #e2e8f0 !important;
            cursor: default;
        }

        label { display: block; font-size: 0.7rem; font-weight: 800; color: #64748b; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.4rem; text-align: center; }

        .btn-unit { background: #e2e8f0; color: #64748b; font-weight: 700; font-size: 0.7rem; padding: 0.5rem; transition: all 0.2s; flex: 1; }
        .btn-unit.active { background: #f59e0b; color: white; }
        
        .card { background: white; border-radius: 1.2rem; border: 1px solid #e2e8f0; box-shadow: 0 4px 12px rgba(0,0,0,0.03); }
        #cut-list-display div { border-left: 4px solid #cbd5e1; text-align: left; background: #f8fafc; color: #64748b; }
    
        /* Click selects whole value */
        input, select { cursor: text; }
        input:focus { cursor: text; }
        /* Action buttons: only colored when 'active-action' */
        .btn-action { background: #e2e8f0; color: #334155; font-weight: 800; font-size: 0.7rem; padding: 0.75rem; transition: all 0.15s; width: 100%; border-radius: 0.75rem; text-transform: uppercase; letter-spacing: 0.12em; border: 1px solid #cbd5e1; }
        .btn-action:hover { background: #cbd5e1; }
        .btn-action.active-action { background: #0f172a; color: #ffffff; border-color: #0f172a; }
        .metric { background: #ffffff; border-radius: 1rem; border: 1px dashed #cbd5e1; padding: 1rem; text-align: center; flex: 1; min-width: 0; }
        .metric .k { font-size: 10px; font-weight: 900; color: #94a3b8; text-transform: uppercase; }
        .metric .v { font-family: 'JetBrains Mono', monospace; font-size: 1.15rem; font-weight: 800; color: #334155; }
        .metric input { background: transparent; border: none; box-shadow: none; padding: 0; font-weight: 800; color: #334155; }
        #cut-list-display div { text-align: center; }

    </style>
</head>
<body class="pb-20">

    <header class="py-8 text-center flex flex-col items-center">
        <img src="uploaded file ChatGPT Image 18. Feb. 2026, 17_14_05.jpg" alt="Schnittchen" class="max-w-[280px] mb-4">
        <h1 id="ttl" class="text-3xl font-extrabold tracking-tight text-slate-900 mt-2">Schnittchen</h1>
        <p id="subttl" class="text-slate-500 text-sm font-semibold mt-1">Catchy subtext</p>
        <div class="flex gap-2">
            <button onclick="setLang('de')" id="l-de" class="text-[10px] font-bold px-3 py-1 bg-amber-500 text-white rounded uppercase">DE</button>
            <button onclick="setLang('en')" id="l-en" class="text-[10px] font-bold px-3 py-1 bg-slate-200 text-slate-600 rounded uppercase">EN</button>
        </div>
    </header>

    <div class="max-w-6xl mx-auto px-4">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
            
            <div class="lg:col-span-4 space-y-5 card p-6 flex flex-col items-center">
                <div class="w-full">
                    <label id="lbl-unit">Einheit & Maßbasis</label>
                    
                    <div class="flex bg-slate-100 rounded-lg overflow-hidden p-1 gap-1 mb-2">
                        <button onclick="setUnit('mm')" id="u-mm" class="btn-unit rounded-md active">MM</button>
                        <button onclick="setUnit('cm')" id="u-cm" class="btn-unit rounded-md">CM</button>
                        <button onclick="setUnit('inch')" id="u-inch" class="btn-unit rounded-md">IN</button>
                    </div>

                    <select id="type" onchange="calculate()" class="text-center">
                        <option value="outside" id="opt-outside">Außenmaß (Standard)</option>
                        <option value="inside" id="opt-inside">Innenmaß (Lichtes Maß)</option>
                    </select>
                </div>

                <div class="grid grid-cols-2 gap-3 w-full">
                    <div><label id="lbl-qty">Menge</label><input type="number" id="qty" value="1" oninput="calculate()" onfocus="this.select()" onclick="this.select()"></div>
                    <div><label id="lbl-thick">Wandstärke</label><input type="number" id="thickness" value="18" oninput="calculate()" onfocus="this.select()" onclick="this.select()"></div>
                </div>

                <div class="grid grid-cols-3 gap-2 py-4 border-y border-slate-100 w-full">
                    <div><label id="lbl-len">Länge</label><input type="number" id="length" value="400" oninput="calculate()" onfocus="this.select()" onclick="this.select()"></div>
                    <div><label id="lbl-width">Breite</label><input type="number" id="width" value="300" oninput="calculate()" onfocus="this.select()" onclick="this.select()"></div>
                    <div><label id="lbl-height">Höhe</label><input type="number" id="height" value="150" oninput="calculate()" onfocus="this.select()" onclick="this.select()"></div>
                </div>

                <div class="grid grid-cols-2 gap-3 w-full">
                    <div class="flex flex-col items-center w-full">
                        <label id="lbl-btype">Boden</label>
                        <select id="bottom-type" onchange="calculate()" class="text-center">
                            <option value="inside" id="opt-binside">Boden Innen</option>
                            <option value="bottom" id="opt-bbottom">Boden Außen</option>
                        </select>
                    </div>
                    <div><label id="lbl-bthick">Stärke</label><input type="number" id="bottom-thick" value="18" oninput="calculate()" onfocus="this.select()" onclick="this.select()"></div>
                </div>

                <div class="w-full">
                    <label id="lbl-wood">Material</label>
                    <input type="text" id="wood-type" value="Multiplex Birke" oninput="calculate()" onfocus="this.select()" onclick="this.select()">
                </div>
            </div>

            <div class="lg:col-span-8 space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                    <div class="card p-6 flex flex-col justify-between">
                        <div>
                            <h2 class="font-bold uppercase text-slate-400 text-[10px] tracking-widest mb-4" id="lbl-list">Stückliste</h2>
                            <div id="cut-list-display" class="space-y-2 font-mono text-[12px]"></div>

                    <div class="bg-slate-900 rounded-2xl overflow-hidden h-[380px] shadow-xl relative border-b-8 border-amber-500">
                        <div id="canvas-container" class="w-full h-full"></div>
                    </div>

                </div>
                        
                        <div class="mt-6 pt-4 border-t space-y-2">
                            <button onclick="copyListOnly()" id="btn-copylist" class="btn-action">Kopieren (TXT)</button>
                            <button onclick="copyEmail()" id="btn-copyemail" class="btn-action">Mail (TXT)</button>
                        </div>
                    </div>
                </div>

                
                <div class="flex flex-col md:flex-row gap-3">
                    <div class="metric">
                        <div class="k" id="lbl-vol">Volumen / Box</div>
                        <div id="val-vol" class="v">0.000 m³</div>
                    </div>
                    <div class="metric">
                        <div class="k" id="lbl-area">Materialbedarf</div>
                        <div id="val-area" class="v">0.00 m²</div>
                    </div>
                    <div class="metric">
                        <div class="k" id="lbl-price-label">Preis / m²</div>
                        <div class="v"><input type="number" id="price-sqm" value="45" oninput="calculate()" onfocus="this.select()" onclick="this.select()" class="text-center w-full"></div>
                    </div>
                    <div class="metric">
                        <div class="k" id="lbl-total">Gesamtpreis</div>
                        <div id="val-price" class="v">0.00 €</div>
                    </div>
                </div>

    </div>

    <script>
        let scene, camera, renderer, controls, parts = [];
        let unit = 'mm';
        let lang = 'de';

        function round3(x) {
            if (typeof x !== 'number' || !isFinite(x)) return 0;
            const s = (Math.round(x * 1000) / 1000).toString();
            return s;
        }

        function projectNumber() {
            // e.g. P-20260219-1905-4821
            const d = new Date();
            const pad = (n) => String(n).padStart(2,'0');
            const stamp = `${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}-${pad(d.getHours())}${pad(d.getMinutes())}`;
            const rnd = Math.floor(1000 + Math.random()*9000);
            return `P-${stamp}-${rnd}`;
        }

        const dict = {
            de: {
                ttl: "Schnittchen",
                subttl: "Catchy subtext",
                unit: "Einheit & Maßbasis",
                outside: "Außenmaß (Standard)",
                inside: "Innenmaß (Lichtes Maß)",
                qty: "Menge",
                thick: "Wandstärke",
                len: "Länge",
                width: "Breite",
                height: "Höhe",
                btype: "Boden",
                binside: "Boden Innen",
                bbottom: "Boden Außen",
                bthick: "Stärke",
                wood: "Material",
                list: "Stückliste",
                area: "Materialbedarf",
                vol: "Volumen / Box",
                "price-label": "Preis / m²",
                total: "Gesamtpreis",
                copy: "Kopieren (TXT)",
                mail: "Mail (TXT)"
            },
            en: {
                ttl: "Schnittchen",
                subttl: "Catchy subtext",
                unit: "Units & basis",
                outside: "Outside dimensions (default)",
                inside: "Inside dimensions (clearance)",
                qty: "Quantity",
                thick: "Wall thickness",
                len: "Length",
                width: "Width",
                height: "Height",
                btype: "Bottom",
                binside: "Bottom inside",
                bbottom: "Bottom outside",
                bthick: "Thickness",
                wood: "Material",
                list: "Cutting list",
                area: "Material needed",
                vol: "Volume / box",
                "price-label": "Price / m²",
                total: "Total price",
                copy: "Copy (TXT)",
                mail: "Email (TXT)"
            }
        };

        function setLang(l) {
            lang = l;
            document.getElementById('l-de').className = l === 'de' ? 'text-[10px] font-bold px-3 py-1 bg-amber-500 text-white rounded uppercase' : 'text-[10px] font-bold px-3 py-1 bg-slate-200 text-slate-600 rounded uppercase';
            document.getElementById('l-en').className = l === 'en' ? 'text-[10px] font-bold px-3 py-1 bg-amber-500 text-white rounded uppercase' : 'text-[10px] font-bold px-3 py-1 bg-slate-200 text-slate-600 rounded uppercase';
            const d = dict[lang];

            // labels/options
            Object.keys(d).forEach(key => {
                const el = document.getElementById('lbl-' + key) || document.getElementById('opt-' + key) || document.getElementById(key);
                if (el) el.innerText = d[key];
            });

            // headline + subtext
            if (document.getElementById('ttl')) document.getElementById('ttl').innerText = d.ttl;
            if (document.getElementById('subttl')) document.getElementById('subttl').innerText = d.subttl;

            // buttons
            const b1 = document.getElementById('btn-copylist');
            const b2 = document.getElementById('btn-copyemail');
            if (b1) b1.innerText = d.copy;
            if (b2) b2.innerText = d.mail;

            calculate();
        }

        function init3D() {
            const container = document.getElementById('canvas-container');
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(40, container.clientWidth / container.clientHeight, 1, 10000);
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            scene.add(new THREE.AmbientLight(0xffffff, 0.9));
            const sun = new THREE.DirectionalLight(0xffffff, 0.3);
            sun.position.set(200, 300, 100);
            scene.add(sun);
            calculate();
            animate();
        }

        function setUnit(u) {
            const old = unit;
            if (old === u) return;

            const toMM = { mm: 1, cm: 10, inch: 25.4 };
            const factor = toMM[old] / toMM[u];

            // convert all dimensional inputs to keep the same physical size
            ['length','width','height','thickness','bottom-thick'].forEach(id => {
                const el = document.getElementById(id);
                const v = parseFloat(el.value);
                if (!isNaN(v)) el.value = (v * factor).toFixed(3).replace(/\.000$/, '');
            });

            unit = u;
            document.querySelectorAll('.btn-unit').forEach(b => b.classList.remove('active'));
            const btn = document.getElementById('u-' + u);
            if (btn) btn.classList.add('active');

            calculate();
        }

        function calculate() {
            const L = parseFloat(document.getElementById('length').value) || 0;
            const W = parseFloat(document.getElementById('width').value) || 0;
            const H = parseFloat(document.getElementById('height').value) || 0;
            const T = parseFloat(document.getElementById('thickness').value) || 0;
            const BT = parseFloat(document.getElementById('bottom-thick').value) || 0;
            const Q = parseInt(document.getElementById('qty').value) || 1;
            const bType = document.getElementById('bottom-type').value;
            const mode = document.getElementById('type').value;

            // Panel sizes (according to the chosen measuring mode)
            let fL, sL, wallH;

            if (mode === 'outside') {
                // outside dims entered
                fL = L;
                sL = W - (2 * T); // side depth between front/back
                wallH = (bType === 'bottom') ? (H - BT) : H;
            } else {
                // inside dims entered
                fL = L + (2 * T);
                sL = W; // inside width between front/back
                wallH = H;
            }

            // Outer dimensions used for 3D assembly
            const outerL = fL;
            const innerW = sL;
            const outerW = innerW + 2 * T;

            // Bottom size depends on type
            const bottomL = (bType === 'inside') ? Math.max(outerL - 2*T, 0) : outerL;
            const bottomW = (bType === 'inside') ? Math.max(outerW - 2*T, 0) : outerW;

            // Cutting list text
            document.getElementById('cut-list-display').innerHTML = `
                <div class="p-2 border-l-4 border-slate-300"><b>${2*Q}x Front / Back</b><br>${round3(outerL)} x ${round3(wallH)} ${unit}</div>
                <div class="p-2 border-l-4 border-slate-300"><b>${2*Q}x Sides</b><br>${round3(innerW)} x ${round3(wallH)} ${unit}</div>
                <div class="p-2 border-l-4 border-slate-300"><b>${1*Q}x Bottom</b><br>${round3(bottomL)} x ${round3(bottomW)} ${unit}</div>
            `;

            update3D(outerL, outerW, innerW, bottomL, bottomW, wallH, T, BT, bType);

            // Area (m²) from chosen unit
            const areaUnits = ((2*outerL*wallH) + (2*innerW*wallH) + (bottomL*bottomW)) * Q;
            const areaFactor = { mm: 1e-6, cm: 1e-4, inch: 0.00064516 }[unit] || 1e-6;
            const area = areaUnits * areaFactor;

            document.getElementById('val-area').innerText = area.toFixed(2) + " m²";

            const priceSqm = parseFloat(document.getElementById('price-sqm').value) || 0;
            document.getElementById('val-price').innerText = (area * priceSqm).toFixed(2) + " €";

            // Volume per box (m³) - based on inner space
            let innerL, innerH;
            if (mode === 'outside') {
                innerL = Math.max(L - 2*T, 0);
                innerH = Math.max(H - BT, 0);
            } else {
                innerL = Math.max(L, 0);
                innerH = (bType === 'inside') ? Math.max(H - BT, 0) : Math.max(H, 0);
            }
            const toM = { mm: 0.001, cm: 0.01, inch: 0.0254 }[unit] || 0.001;
            const vol = (innerL * innerW * innerH) * (toM ** 3);
            const volEl = document.getElementById('val-vol');
            if (volEl) volEl.innerText = vol.toFixed(3) + " m³";
        }

        function update3D(outerL, outerW, innerW, bottomL, bottomW, wallH, T, BT, bType) {
            parts.forEach(p => scene.remove(p));
            parts = [];

            const mat = new THREE.MeshLambertMaterial({ color: 0xe2e8f0 });
            const edgeMat = new THREE.LineBasicMaterial({ color: 0x94a3b8 });

            const box = (w, h, d, x, y, z) => {
                if (w <= 0 || h <= 0 || d <= 0) return;
                const geo = new THREE.BoxGeometry(w, h, d);
                const mesh = new THREE.Mesh(geo, mat);
                mesh.position.set(x, y, z);
                mesh.add(new THREE.LineSegments(new THREE.EdgesGeometry(geo), edgeMat));
                scene.add(mesh);
                parts.push(mesh);
            };

            // Bottom: centered; if outside bottom, it matches outer dims, otherwise it sits inside the walls
            box(bottomL, BT, bottomW, 0, BT / 2, 0);

            // Walls: if bottom is outside, walls sit on top of it
            const yW = (bType === 'bottom') ? (BT + wallH / 2) : (wallH / 2);

            // Front & Back: full outer length, thickness = T, placed at outer width
            const zFB = (outerW / 2 - T / 2);
            box(outerL, wallH, T, 0, yW, zFB);
            box(outerL, wallH, T, 0, yW, -zFB);

            // Sides: thickness = T, depth = innerW (between front/back)
            const xS = (outerL / 2 - T / 2);
            box(T, wallH, innerW, xS, yW, 0);
            box(T, wallH, innerW, -xS, yW, 0);

            const max = Math.max(outerL, outerW, wallH);
            camera.position.set(max * 1.8, max * 1.2, max * 1.8);
            controls.target.set(0, yW, 0);
            controls.update();
        }

        function animate() { requestAnimationFrame(animate); renderer.render(scene, camera); }

        function flashActive(id) {
            const b = document.getElementById(id);
            if (!b) return;
            b.classList.add('active-action');
            setTimeout(() => b.classList.remove('active-action'), 900);
        }

        function copyListOnly() {
            const list = document.getElementById('cut-list-display').innerText.trim();
            navigator.clipboard.writeText(list).then(() => {
                flashActive('btn-copylist');
                alert(lang === 'de' ? "Stückliste kopiert!" : "Cutting list copied!");
            });
        }

        function copyEmail() {
            const wood = (document.getElementById('wood-type').value || '').trim();
            const T = (parseFloat(document.getElementById('thickness').value) || 0);
            const BT = (parseFloat(document.getElementById('bottom-thick').value) || 0);
            const Q = (parseInt(document.getElementById('qty').value) || 1);
            const list = document.getElementById('cut-list-display').innerText.trim();

            const pn = projectNumber();

            const subjectDE = `Projekt ${pn} – Zuschnitt-Anfrage`;
            const subjectEN = `Project ${pn} – Cutting request`;

            const greetingDE = `Sehr geehrte Damen und Herren,`;
            const greetingEN = `Dear Sir or Madam,`;

            const askDE = `bitte erstellen Sie ein Angebot für den Zuschnitt der folgenden Teile.`;
            const askEN = `please provide a quotation for cutting the parts listed below.`;

            const materialLineDE = `Material: ${wood || "—"} | Wandstärke: ${round3(T)} ${unit} | Bodenstärke: ${round3(BT)} ${unit} | Menge: ${Q}`;
            const materialLineEN = `Material: ${wood || "—"} | Wall thickness: ${round3(T)} ${unit} | Bottom thickness: ${round3(BT)} ${unit} | Quantity: ${Q}`;

            const fallbackDE = `Falls das Material nicht verfügbar ist, bitte ein Angebot für ein möglichst ähnliches Material (Qualität/Preis) erstellen.`;
            const fallbackEN = `If the requested material is not available, please quote a closely comparable material (quality/price).`;

            const closingDE = `Freundliche Grüße\nEin Kunde`;
            const closingEN = `Kind regards\nA customer`;

            const subject = (lang === 'de') ? subjectDE : subjectEN;
            const body = (lang === 'de')
                ? `${subject}\n\n${greetingDE}\n\n${askDE}\n\n${materialLineDE}\n\nStückliste:\n${list}\n\n${fallbackDE}\n\n${closingDE}`
                : `${subject}\n\n${greetingEN}\n\n${askEN}\n\n${materialLineEN}\n\nCutting list:\n${list}\n\n${fallbackEN}\n\n${closingEN}`;

            navigator.clipboard.writeText(body).then(() => {
                flashActive('btn-copyemail');
                alert(lang === 'de' ? "Mail-Text kopiert!" : "Email text copied!");
            });
        }

        window.onload = () => { init3D(); setLang('de'); };
    </script>
</body>
</html>
 
